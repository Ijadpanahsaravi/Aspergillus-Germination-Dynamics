max_swelling <- t %>%
  group_by(ObjectId) %>%
  mutate(NextStatus = lead(status)) %>%
  filter(status == 1 & (NextStatus == 2 | is.na(NextStatus))) %>%
  reframe(
    MaxSwellingArea = if (all(is.na(Area))) NA_real_ else max(Area, na.rm = TRUE),
    TimeOfMaxSwelling = if (all(is.na(Area))) NA_real_ else time[which.max(Area)] / 60
  ) %>%
  ungroup()


min_swelling <- t %>%
  group_by(ObjectId) %>%
  filter(status == 1) %>% 
  summarise(MinSwellingArea = min(Area, na.rm = TRUE), 
            TimeOfMinSwelling = time[which.min(Area)] / 60,
            .groups = 'drop') %>%
  ungroup()

df_with_max_swelling <- left_join(df, max_swelling, by = "ObjectId")
df_final <- left_join(df_with_max_swelling, min_swelling, by = "ObjectId")


extended_summary <- df_final %>%
  group_by(well) %>%
  summarise(EndTimeOfMaxSwelling_mean = mean(TimeOfMaxSwelling, na.rm = TRUE), #the average maximum time for the initiation of germ tube formation.
    MinSwellingArea_mean = mean(MinSwellingArea, na.rm = TRUE),# I'm not sure if it's necessary to show!
    MaxSwellingArea_mean = mean(MaxSwellingArea, na.rm = TRUE), # average maximum swelling in different treatments
    StartTimeOfSwelling_mean = mean(TimeOfMinSwelling, na.rm = TRUE),# average minimum time to start swelling
    NumberOfObjects = n()  # Number of observed objects per well remains unchanged
  )
